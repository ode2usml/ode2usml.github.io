<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>My GitHub Pages Video</title>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // 🔐 Passphrase Protection
        const correctPassphrase = "yourSecret123"; // Change this!
        const userInput = prompt("Enter passphrase to access this page:");
        if (userInput !== correctPassphrase) {
          alert("Incorrect passphrase. Redirecting...");
          window.location.href = "https://google.com";
          return;
        }

        // 🎥 Video Timestamp Trigger (30 seconds)
        const video = document.getElementById("myVideo");
        let hasNotified = false;
        const triggerTime = 30; // seconds

        video.addEventListener("timeupdate", function () {
          if (!hasNotified && video.currentTime >= triggerTime) {
            hasNotified = true;
            notifyPlayEvent();
          }
        });

        // 📬 Notify with Device Info via IFTTT
        function notifyPlayEvent() {
          const userAgent = navigator.userAgent;
          const message = `🎬 Video watched past 30 seconds!\nDevice Info: ${userAgent}`;

          console.log("Sending to IFTTT:\n", message); // For debugging

          fetch("https://maker.ifttt.com/trigger/video_played/with/key/d2_s_jC9bzjrP4p9VKPeQ0", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ value1: message })
          });
        }
      });
    </script>
  </head>
  <body>
    <h1>Hello World</h1>
    <p>I'm hosted with GitHub Pages.</p>

    <!-- Video -->
    <video id="myVideo" width="640" controls>
      <source src="assets/video.mp4" type="video/mp4" />
      Your browser does not support the video tag.
    </video>
  </body>
</html>
